Public Class SelectMyDirectoryCommand : Inherits RpaCommandBase
    Private Function Check(ByRef dat As RpaDataWrapper) As Integer
        If dat.Project.MyDirectories.Count <= 0 Then
            Console.WriteLine($"'MyDirectories' にリストが存在しません")
            Return 1000
        End If

        Dim idx As Integer = -1
        Console.WriteLine($" ID  | ディレクトリ名")
        Console.WriteLine($"-----+----------------------------------------------------------------")
        For Each mydir In dat.Project.MyDirectories
            Dim idxno As String = String.Format("{0, 4"}, dat.Project.MyDirectories.IndexOf(mydir)
            Console.WriteLine($"{idxno} | {mydir}")
        Next
        Console.WriteLine()
        Do 
            idx = -1
            Console.WriteLine("'ID'を選択してください")
            Dim idxstr As String = dat.Transaction.ShowRpaIndicator(dat)
            Console.WriteLine()

            If Not IsNumeric(idxstr) Then
                Continue Do
            End If

            idx = Integer.Parse(idxstr)
            If idx < dat.Project.MyDirectories.IndexOf(dat.Project.MyDirectories.First) Then
                Continue Do
            End If
            If idx > dat.Project.MyDirectories.IndexOf(dat.Project.MyDirectories.Last) Then
                Continue Do
            End If
            Exit Do
        Loop Until False
        
        If Not Directory.Exists(dat.Project.MyDirectories(idx)) Then
            Console.WriteLine($"ディレクトリ '{dat.Project.MyDirectories(idx)}' は存在しません")
            Return 1000
        End If

        Do
            Dim yorn As String
        Loop Until False
    End Function

    Private Function Main(ByRef dat As RpaDataWrapper) As Integer

    End Function

    Sub New()
        Me.CanExecuteHandler = AddressOf Check
        Me.ExecuteHandler = AddressOf Main
    End Sub
End Class
